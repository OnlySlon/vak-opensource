mailserv.faq v.1.2

Ниже приведена текущая версия сборника вопросов-ответов по файловому
серверу mailserv@kiae.su. Мы старались охватить все проблемы, возникающие
у пользователей, впервые начинающих общаться с сервером.

	  Часто задаваемые вопpосы по файловому сеpвеpу
	  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	       mailserv@kiae.su сети EUnet/Relcom
	       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                         Версия 1.2

                 Сергей Вакуленко, vak@kiae.su
                Леонид Яснопольский, lny@kiae.su

Содержание:

     * Что такое файловый сеpвеp сети EUnet/Relcom.
     * Что такое Киархив.
     * Как обpатиться к сеpвеpу.
     * Как взять файл с сеpвеpа.
     * Как взять недостающую часть файла.
     * Как pаскодировать файлы, пpиходящие с сеpвеpа.
     * Как распаковать файлы типа '.Z'.
     * Как распаковать файлы типа '.F'.
     * Как распаковать файлы типа '.tar.Z'.
     * Где взять пpогpаммы pаспаковки для Unix.
     * Где взять пpогpаммы pаспаковки для MS-DOS.
     * Как получить список новых поступлений.
     * Как положить файл в Киархив.

________________________________________________________________
* Что такое файловый сеpвеp сети EUnet/Relcom.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Это специальная программа, постоянно функционирующая на одной из узловых
машин сети EUnet/Relcom, назначение которой - прием и выполнение запросов
от абонентов.  Запросы принимаются по электронной почте.  После выполнения
запроса результат высылается по обратному адресу абонента.

В сети Internet существует много подобных серверов, и в сети EUnet/Relcom
сейчас их уже несколько, но в данной статье речь будет идти о
mailserv@kiae.su (далее просто "сервер").

Смысл существования данного сервера - обеспечение удаленного
доступа к архивам программ, телеконференций, картинок и прочего,
что предназначено для широкого распространения по сети.
Поэтому сервер называется "файловым", так как основная его
операция - заказ файлов.

________________________________________________________________
* Что такое Киархив.
~~~~~~~~~~~~~~~~~~~~
   Сервер mailserv@kiae.su обеспечивает доступ к файлам, расположенным
в Киархиве. Приведем здесь содержимое соответствующего файла readme:

readme v.0.1

		  Краткие сведения о Киархиве

   Киархив - архив общедоступных материалов узла kiae сети EUnet/Relcom.

   (Вы читаете файл readme, хранящийся в корневом каталоге Киархива).

   Эксплуатируется на компьютерах, расположенных в Центральном вычисли-
тельном комплексе Росийского научного центра "Курчатовский Институт"
(Москва), работающих под управлением ОС UN*X.

   В архиве размещены материалы (программы, документация, изображения,
справочная информация и т.д.), представляющие интерес для широкого
круга компьютеризированной общественности и имеющие статус public domain,
freeware, GNU Licence, shareware.

   Доступ к архиву осуществляется:
- по электронной почте, через файловый сервер mailserv@kiae.su (далее -
просто 'mailserv');
- через anonymous FTP;
- по UUCP (kiae!/PUB/).

   Справочная информация по содержимому Киархива находится в файлах:
- *.inf     (информация о конкретном материале);
- Index     (список файлов данного каталога с комментариями);
- FullIndex (включает файлы Index текущего и всех дочерних каталогов);
- ls-lR.Z   (полный список файлов без комментариев, расположен в корневом
каталоге).
   (Примечание. Здесь и далее под 'корневым каталогом' следует понимать
корневой каталог при доступе через mailserv@kiae.su и через anonymous FTP
и каталог kiae!/PUB/ - при доступе по UUCP).
   Файлы Index, FullIndex и ls-lR.Z обновляются ежесуточно.
   (В файле admin/indexinf содержится подробное описание перечисленных
файлов).

   Большая часть материалов в Киархиве хранится в "упакованном"
виде, т.е. в виде архивных файлов, созданных архиваторами zip, arj,
zoo, и т.д. Необходимые Вам распаковщики могут быть найдены в
каталогах unix/arcers и msdos/arcers .


   Обратите внимание на следующие файлы:

   unix/arcers/*     - упаковщики/распаковщики/архиваторы для Un*x
   msdos/arcers/*    - упаковщики/распаковщики/архиваторы для Msdos
   faq/*             - различные FAQ (Frequently Asked Questions
			 с ответами), в т.ч. ЧаВО Е.Пескина и
   faq/mailserv.faq  - ответы на часто задаваемые вопросы про
			 mailserv@kiae.su
   admin/indexinf    - подробное описание справочных файлов
			 (*.inf, Index, FullIndex и ls-lR.Z)
   admin/upload.frm  - регистрационный бланк для размещения новых
			 материалов в Киархиве

   Все вопросы/замечания/жалобы/предложения по ведению Киархива просьба
присылать по адресу: arcman@kiae.su .

________________________________________________________________
* Как обpатиться к сеpвеpу.
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Чтобы обратиться к серверу, нужно послать письмо с заданием по адресу
"mailserv@kiae.su".  Простейшее задание - команда HELP, по которой
сервер вышлет краткое описание своих команд.  Например:

    % mail mailserv@kiae.su
    Subject: неважно
    HELP
    .

Задание для сервера нужно завершать командой QUIT.  Команда HELP - исключение,
она сама по себе отрабатывает как конец задания.

Если сервер встречает нераспознанную команду или неверно заданные параметры,
он прекращает обработку пакета и возвращает протокол работы с указанием ошибки.

Чтобы посмотреть список файлов на сервере, можно использовать команды
LS и DIR.  Они выдают, соответственно, краткий и подробный список
файлов в текущем каталоге.  Можно указывать параметры - имена файлов или
каталогов, которые Вы хотите посмотреть.  Флаг -R включает режим
рекурсивного просмотра подкаталогов.  Но будьте осторожны!  На больших
каталогах объем вывода команды "DIR -R" может достигнуть нескольких мегабайт!
Иногда возникает необходимость узнать, что изменилось на сервере
за определенный период времени.  Для этого служит флаг "-#", где # определяет
количество суток.  Например, команда "DIR -R -7" выдаст список всех
файлов, которые изменялись за последнюю неделю.

Можно переходить из каталога в каталог командой CD, например "CD msdos".
Команда CD без параметров возвращается в корневой каталог сервера.

Большинство вещей хранятся на сервере запакованными, в виде архивных файлов.
Для некоторых типов архивов можно "заглянуть внутрь" них командой LIST
с параметром - названием архивного файла.  Команда LIST распознает следующие
типы архивов:

    .tar        -- tar
    .tar.Z      -- tar, compress
    .tar.F      -- tar, freeze
    .ar         -- ar
    .ar.Z       -- ar, compress
    .ar.F       -- ar, freeze
    .cpio       -- cpio -c
    .cpio.Z     -- cpio -c, compress
    .cpio.F     -- cpio -c, freeze
    .zip        -- zip
    .zoo        -- zoo
    .lzh        -- lharc

Пример:

    % mail mailserv@kiae.su
    Subject: неважно
    DIR
    LS -5 unix
    LS -R kermit
    CD misc
    LIST pbmplus.zoo
    QUIT
    .

Имена команд можно набирать как строчными, так и прописными буквами,
но в названиях файлов и каталогов эти буквы различаются, так что
будьте внимательны.

________________________________________________________________
* Как взять файл с сеpвеpа.
~~~~~~~~~~~~~~~~~~~~~~~~~~~
Заказать файл с сервера можно командой GET с параметрами - именами файлов.
В именах файлов можно использовать символы-шаблоны '*' и '?'.
Заказать каталог командой GET нельзя.

Получив команду GET, сервер обрабатывает файл по следующему алгоритму.
Файл перекодируется в 7-битное текстовое представление (чтобы
информация не искажалась при прохождении промежуточных узлов,
которые не всегда "пропускают" 8-битные символы) одним из возможных
способов (по умолчанию - UUENCODE) и, если файл слишком большой,
разделяется на несколько более мелких частей.
Части высылаются в виде отдельных писем в адрес абонента.

Перекодирование файлов посредством UUENCODE часто бывает неудобно.
Тип перекодировки можно изменить командой ENCODER с параметром:

    uuencode    -- по умолчанию, принято в Internet
    btoa        -- гораздо компактнее, чем uuencode
    ship        -- тоже неплохо, с автоматической сборкой

Большинство файлов в Киархиве хранится в сжатом (архивированном)
виде, поэтому использовать режим упаковки при отсылке обычно не
требуется. Целесообразно упаковывать большие текстовые файлы.
Вы можете изменить способ упаковки (архивирования) командой
ARCHIVER с параметром:

    none        -- по умолчанию, не паковать
    compress    -- tar, compress (принято в Internet)
    freeze      -- tar, freeze (очень плотно)
    lharc       -- lharc (не lha!)
    zoo         -- zoo h
    zip         -- zip

Сервер обычно старается создавать части размером не больше 30 килобайт.
Эту величину можно изменить командой SIZE с параметром - предельным размером
в килобайтах.

По умолчанию сервер сначала перекодирует файл целиком в 7-битное текстовое
представление, затем "режет" текст на части.  Такой способ иногда вызывает
трудности при сборке файла из частей.  Можно изменить алгоритм на обратный:
сначала поделить файл на части, затем каждую из них по отдельности
перекодировать в текст.  Это делается командой SPLIT с параметром:

    text        -- перекодировать, затем делить на части, по умолчанию
    binary      -- сначала поделить, затем перекодировать

Пример:

    % mail mailserv@kiae.su
    Subject: неважно
    ARCHIVER zoo
    ENCODER btoa
    CD usenix
    SIZE 60
    SPLIT binary
    GET README
    QUIT
    .

Иногда возникает необходимость взять не весь архивный файл целиком,
а вычленить из него один или несколько файлов.  Это можно сделать
командой сервера EXTRACT.  Общий формат команды:

    EXTRACT [-#] archive [file...]

Параметр archive задает имя архивного файла, параметры file... определяют
имена файлов, которые нужно извлечь из архива.  Флаг -#, как и
в команде GET, задает список номеров необходимых частей.
Указанные файлы извлекаются из архива, упаковываются, кодируются
и отсылаются в соответствии с установками команд ARCHIVER, ENCODER,
SPLIT, SIZE.  Если имена файлов не указаны, отсылается весь архив.

Пример:

    % mail mailserv@kiae.su
    Subject: неважно
    ARCHIVER zoo
    ENCODER btoa
    EXTRACT compress.zip compress.exe
    QUIT
    .

________________________________________________________________
* Как взять недостающую часть файла.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Иногда случается, что одна или несколько частей файла не доходят до
адресата.  Сервер позволяет, не заказывая снова весь файл целиком,
получить только недостающие части.  Для этого служит команда "GET -#",
где # - список нужных частей, например:

    % mail mailserv@kiae.su
    Subject: неважно
    GET -3,5-9,13-15 msdos/djgpp/djgpp.zip
    QUIT
    .

В этом примере дозапрашиваются части 3, 5, 6, 7, 8, 9, 13, 14, 15.
Необходимо помнить, что при дозаказе недостающих частей должны быть
указаны такие же команды ARCHIVER, ENCODER, SIZE, SPLIT как и при заказе
исходного файла.

________________________________________________________________
* Как pаскодировать файлы, пpиходящие с сеpвеpа.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Метод раскодирования зависит от того, как файлы были закодированы при
передаче.
Есть три принципиально различных способа:
1) Файл состоит из одной части, кодировка UUENCODE.
2) Файл состоит из одной части, кодировка BTOA или SHIP.
3) Много частей, кодировка UUENCODE или BTOA, деление текстовое (split text).
4) Много частей, кодировка UUENCODE, деление двоичное (split binary).
5) Много частей, кодировка BTOA, деление двоичное (split binary).
6) Много частей, кодировка и деление посредством SHIP.

Метод 1. Файл состоит из одной части, кодировка UUENCODE.

1a  Обычно все почтовые оболочки, такие как mailx, bml, elm имеют
    встроенные команды для обработки файлов в формате UUENCODE.
    В mailx такая команда называется "uu".  Например:

	% mailx
	& uu 3
	& q

    Если Ваша почтовая оболочка не имеет команды перекодировки,
    перейдите к методу 2.

Метод 2. Файл состоит из одной части, кодировка BTOA или SHIP.

2a  Записать письмо в отдельном файле, например, командой mailx "save".
    Аналогичные команды есть и в других почтовых оболочках.

2b  Раскодировать файл соответствующей командой, uudecode, atob или ship.
    Uudecode "помнит" исходное имя файла, но оно может оказаться недопустимым
    в Вашей операционной системе.  В этом случае нужно найти строчку
    вида "begin 644 filename.ext" и скорректировать имя файла.
    Пример:

	uudecode file.uu

    Atob и ship не знают имени файла, и работают как фильтр.
    Пример:

	atob < file.ba > file.bin
	ship -u < file.shp > file.bin

Метод 3. Много частей, кодировка UUENCODE или BTOA, деление текстовое.

3a  Если файл пришел в виде нескольких частей, записать все части в файл
    строго в порядке следования. Это можно сделать в mailx командой "save",
    по одной команде на каждую часть. Дело в том, что mailx сохраняет письма
    в файле не в том порядке, в котором Вы их указываете, а так, как они
    лежат в почтовом ящике, что не всегда правильно.

3b  Выйти из mailx и отредактировать полученный файл, убрав все
    промежуточные заголовки статей. После этого файл должен выглядеть
    одним цельным массивом.

3c  Перейти к пункту 2b.

Метод 4. Много частей, кодировка UUENCODE, деление двоичное.

4a  Каждую часть обработать командой "uu" (см. пункт 1a). При этом будет
    создано нужное количество файлов с именами вида part001, part002 и т.п.

4b  Выйти из mailx и слить полученные файлы в один в порядке их следования,
    в MSDOS это можно сделать командой

	copy/b part001+part002+...+partXXX file.bin

    а в Unix командой

	cat part* > file.bin

Метод 5. Много частей, кодировка BTOA, деление двоичное.

5a  Каждую часть записать в отдельный файл командой mailx "save",
    например, с именами вида part001.ba.

5b  Обработать каждую часть программой atob, например

	btoa < part001.uu > part001

5c  Перейти к пункту 4b.

Метод 6. Много частей, кодировка и деление посредством SHIP.

6a  Каждую часть записать в отдельный файл командой mailx "save",
    например, с именами вида part001.shp.

6b  Обработать полученные файлы программой ship, например

	ship -u part*.shp > file.bin

________________________________________________________________
* Как распаковать файлы типа '.Z'.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Для этого необходимо иметь утилиту compress.  В последних версиях
ОС Unix она обычно присутствует, если же ее у Вас нет, см. ответы
на вопросы 8 и 9.
Для работы compress требуется большое количество оперативной
памяти, около 450 килобайт, что следует учитывать, например, в MSDOS.
Чтобы распаковать файл file.Z, необходимо выполнить команду

    compress -v -d file.Z

Для MSDOS нужно добавить флаг работы в бинарном режиме:

    compress -v -d -i file.Z

________________________________________________________________
* Как распаковать файлы типа '.F'.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Это делается утилитой freeze.  Коэффициент упаковки при этом гораздо
выше, чем у compress, но скорость работы примерно в три раза ниже.
Чтобы распаковать файл file.F, необходимо выполнить команду

    freeze -vv -d file.F

Для MSDOS нужно добавить флаг работы в бинарном режиме:

    freeze -vv -d -i file.F

________________________________________________________________
* Как распаковать файлы типа '.tar.Z'.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Сначала нужно распаковать файл утилитой compress (см. выше).
Полученный файл типа '.tar' разархивируется командой

    tar xvf file.tar

В Unix все это можно проделать одной командой:

    compress -d < file.tar.Z | tar xvf -

В MSDOS обычно возникает вопрос, где взять утилиты compress
и tar (см. ниже).

________________________________________________________________
* Где взять пpогpаммы pаспаковки для Unix.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Программы tar, ar, cpio входят в стандартный набор команд ОС Unix.
Последние версии System V.3 и System V.4 также обычно имеют команду
compress (она же uncompress, zcat).

Тексты программ архивирования, упаковки и перекодирования регулярно
рассылаются по телеконференциям alt.sources, comp.sources.misc и пр.
Тексты и/или исполняемые модули некоторых из них находятся в Киархиве
в каталоге unix/arcers .

________________________________________________________________
* Где взять пpогpаммы pаспаковки для MS-DOS.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Программы pkzip, pkunzip, lharc, lha очень популярны и с ними трудностей
обычно не возникает.  Существуют также программы zip и unzip,
они иногда несовместимы со старыми версиями pkzip (ошибки при сравнении
контрольной суммы).

В Usenet очень популярен архиватор zoo.  Есть также более компактная его
версия, выполняющая только распаковку, она называется booz.

Наибольшие проблемы случаются с утилитами compress и tar. В Киархиве есть
реализации этих программ, работающие в MSDOS.

Тексты и бинарные дистрибутивы программ архивирования, упаковки и
перекодирования для MSDOS регулярно рассылаются в телеконференции
comp.binaries.ibm.pc.

Эти программы можно взять в Киархиве в каталоге msdos/arcers .

________________________________________________________________
* Как получить список новых поступлений.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Проще всего дать команду "DIR -#".  Вы получите список файлов, менявшихся
в течение # последних дней.

Например:

    % mail mailserv@kiae.su
    Subject: неважно
    DIR -3
    QUIT
    .

________________________________________________________________
* Как положить файл в Киархив.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Если Вы хотите внести свой вклад в дело борьбы за свободу обмена
информацией, а именно, положить файл в Киархив для дальнейшего его
распространения, добро пожаловать!
Для этого необходимо заказать файл admin/upload.frm - регистрационную
карточку для размещения Вашего материала в Киархиве - и действовать
по приведенной там инструкции.

К информации, размещаемой в Киархиве, предъявляются такие требования:
1) она должна представлять интерес для абонентов сети;
2) не должна иметь только рекламного характера;
3) ее распространение не должно нарушать ничьих прав (собственности,
авторских и пр.), в частности, матобеспечение должно быть public domain,
freeware или shareware и т.п.

------------------------------------------------------------------------

Вопросы по функционированию mailserv@kiae.su просьба присылать
его автору Сергею Вакуленко по адресу:
  vak@kiae.su .

Вопросы по работе Киархива просьба присылать
его администраторам по адресу:
  arcman@kiae.su .

Прошу все мысли на тему уточнения и расширения списка вопросов,
устранения неточностей и прочие конструктивные предложения по
данному документу направлять Леониду Яснопольскому по адресу:
  lny@kiae.su .
