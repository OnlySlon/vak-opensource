
     
     УТВЕРЖДЕН
ИЫ.99999-01 33 01-ЛУ









     
     
     
     
     
     
     
     
     
             Вычислительный комплекс "Эльбрус 1-КБ"
                  Диспетчер Виртуальных Систем
                        Автономный сервис
                      Руководство оператора
                        ИЫ.99999-01 33 01

                        Редакция 28.02.89
     
     
     
     
     
     
     
     
     
     
     
     
     
  
     




















                              1988

                             - 2 -
     
        Инструментальное средство для управления обменом
               информацией между МВК "Эльбрус-1К2"
                       и ВК "Эльбрус 1-КБ"
     
     1. Общие сведения.
     Описываемый инструмент предназначен для обмена информацией
между МВК "Эльбрус-1К2" (Э1К2) и ВК "Эльбрус 1-КБ" (ВКБ),  сое-
динЯнными через программно управляемый канал Э1К2 и универсаль-
ный  канал  ВКБ. В инструменте реализован следующий набор функ-
ций:
     - настройка на заданный номер канала Э1К2;
     - опрос состояния входной и выходной шин канала Э1К2;
     - задание значения выходной шины канала;
     - загрузка файла Э1К2 в ОП ВКБ;
     - запись блока ОП ВКБ в файл Э1К2;
     - настройка на заданный НМД и пакет МД ВКБ;
     - запись блока ОП ВКБ на МД ВКБ;
     - чтение блока с МД ВКБ в ОП ВКБ.
     
     2. Порядок работы.
     2.1. Вызов на ВКБ. Для вызова компоненты инструмента, фун-
кционирующей на ВКБ, необходимо выполнить следующие действия:
     - обнулить процессор;
     - прочесть код компоненты с ГМД в ОП ВКБ с помощью приказа
       пультовой машины "ЗАГ СЫ НКАНАЛ";
     - пустить процессор приказом "АР".
     2.2. Вызов на Э1К2. Для вызова компоненты, функционирующей
на Э1К2, необходимо выполнить следующие действия:
     - вызвать пакетно-диалоговый монитор по ключу "ПАСКАЛ";
     - если предполагается передача файлов, то  настроиться  на
       библиотеку приказом "А КАНАЛ <имя_биб>";
     - вызвать инструмент приказом "КАНАЛ".
     2.3. Описание приказов.
     2.3.1. " КАНАЛ <N_кан> ". Задание номера программно управ-
ляемого канала Э1К2.
     2.3.2. " " (пустая посылка). Опрос входной шины канала.
     2.3.3. " . " (точка). Опрос выходной шины канала.
     2.3.4. " ВЫД <восьмеричное> ". Занесение кода на  выходную
шину канала.
     2.3.5.  "  ФАЙЛ  ".  Обмен файлом. После ввода приказа за-
даЯтся вопрос " КУДА? ", на который в случае передачи  файла  с
ВКБ на Э1К2 следует ответить " СЮДА ", иначе - " ТУДА ". В слу-
чае приЯма файла с ВКБ задаЯтся вопрос " ДЛИНА В СЛОВАХ(16)- ",
в  ответ на который следует задать длину пересылаемого блока ОП
ВКБ в шестнадцатеричной системе счисления.  Затем  в  ответ  на
вопрос  "  ФАЙЛ=  "  следует  ввести  имя  файла  в  библиотеке
<имя_биб>. После этого следует вопрос " НАЗ= ", в ответ на  ко-
торый необходимо ввести начальный адрес блока ОП ВКБ.
     2.3.6.  "  ДИСК  <N_тома>  <N_устр> ". Задание номера тома
(десятичное) и номера НМД (шестнадцатеричное) ВКБ.
     2.3.7. " ЧТ <нач_адр_ОП>  <кон_адр_ОП>  <нач_адр_диск>  ".
Считывание  информации с НМД в ОП ВКБ. Все параметры шестнадца-
теричные.
     2.3.8. " ЗП <нач_адр_ОП>  <кон_адр_ОП>  <нач_адр_диск>  ".
Запись  информации  из ОП ВКБ на МД. Все параметры шестнадцате-
ричные.








                             - 3 -

     2.4.  Инструмент  предоставляет  возможность выполнять ряд
действий в автономном режиме (без участия Э1-К2). В этом случае
действия  пункта 2.2 не выполняются, а параметры приказов запи-
сываются в ОП ВКБ с помощью пультовой машины.
     Порядок действий в автономном режиме таков:
     - выполнить действия пункта 2.1;
     - остановить и ообнулить процессор;
     - задать параметры работы;
     - передать управление по адресу 3E010.
     Область параметров располагается по адресу 3E000 и занима-
ет 10H слов ОП. Нулевое слово параметров несЯт информацию о ви-
де работы и может принимать следующие значения:
     0 - работа с Э1-К2 через универсальный канал;
     1 - обмен информацией между ОП и НМД.
     2.4.1. При работе с Э1-К2 никакие дополнительные параметры
не нужны.
     2.4.2. Для обмена с НМД надо задать такие параметры:
     3E001 - 0 - запись на НМД;
             1 - чтение с НМД;
     3E002 - номер канала, к которому подключен НМД;
     3E003 - адрес НМД на канале;
     3E004 - имя пакета МД;
     3E005 - адрес массива в ОП;
     3E006 - номер блока на томе;
     3E007 - количесто слов ОП, участвующих в обмене.
     3. Автономный сервис представляет средства для  подготовки
пакетов  МД к работе в ДВС, ремонт дорожек МД при их порче, пе-
реписи данных между ОЗУ->МД, МД->ОЗУ, МЛ->МД.  Помимо  этого  в
его  состов входит дисковый тест, который обеспечивает тестиро-
вание пакета МД (с учетом структуры дорожек  предусмотренной  в
ДВС),  проверку взаимодействия канала ВК Э1-КБ и контроллера ЕС
5066.
     3.1 Для анализа работоспособности  канала,  контроллера  и
качества носителя, а также для выработки рекомендации по устра-
нению  неисправности,  вся  информация о сбое протоколируется в
буфере " БУФ_СТА ". Кадр о сбое занимает шесть ячеек их  содер-
жимое следующее:
     - управляющее слово канала (УСК) на момент сбоя;
     - цилиндр, головка;
     - слово состояния канала (ССК);
     - байты уточненного состояния (БУС).
Буфер  статистики рассчитан на 50 кадров о сбое после чего фик-
сируется переполнение буфера (СТОП 34Н).
     Выбор выполняемого действия определяется содержимым ячейки
" ВИД_РАБ " и в зависимости от  него  происходит  интерпретация
содержимого  некоторых переменных. Перед началом работы с авто-
номным сервисом необходимо  создание  массива  сетевых  номеров
контроллеров, если они не совпадают со стандартными значениями,
при этом нулевой элемент массива " СЕТ_НОМ " указывает на номер
контроллера подключенного к нулевому каналу и т.д. Помимо этого
необходимо задание следующих переменных :
     -  номера активного канала " НОМ_КАН ";
     -  номера активного устройства " НОМ_УСТ ";
     -  номера пакета " НОМ_ПАК ".
     4. "ВИД_РАБ"=0  Форматирование пакета.
     Форматирование  пакета  МД  является изначальным действием
при установке ДВС. Оно предназначено для разметки пакета  МД  в
соответствии  со  структурой  дорожки  принятой в ДВС. При этом
также осуществляется отбраковка дефектных дорожек, формирование
метки тома и каталога разделов пакета. Структура дорожки  тако-
ва, что на ней размещается десять записей. Размер каждой записи
131 слово 72 разрядное, из них 3 слова предназначены для хране-
ния служебной информации, а 128 слов информационные. Для запус-
ка форматирования необходимо задание следующих
